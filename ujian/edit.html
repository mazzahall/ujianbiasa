<!DOCTYPE html>
<html lang="id">
  <head>
    <meta charset="UTF-8" />
    <title>Edit Data</title>
    <link rel="stylesheet" href="style.css" />
    <script src="https://cdn.jsdelivr.net/npm/sweetalert2@11"></script>
  </head>
  <body>
    <header>
      <h1>✏️ Edit Data Diri</h1>
      <button onclick="window.location.href='index.html'" class="btn">
        ⬅️ Kembali
      </button>
    </header>

    <main class="card">
      <form id="edit-form">
        <label for="nama">👤 Nama</label>
        <input type="text" id="nama" required />

        <label for="umur">🎂 Umur</label>
        <input type="number" id="umur" min="1" required />

        <label for="alamat">🏠 Alamat</label>
        <input type="text" id="alamat" required />

        <button type="submit" class="btn btn-primary">
          💾 Simpan Perubahan
        </button>
      </form>
    </main>

    <script>
      // Ambil ID dari URL
      const urlParams = new URLSearchParams(window.location.search);
      const index = urlParams.get("index");

      let data = JSON.parse(localStorage.getItem("dataDiri")) || [];
      const form = document.getElementById("edit-form");

      // Kalau index tidak valid
      if (index === null || !data[index]) {
        Swal.fire("Error", "Data tidak ditemukan!", "error").then(() => {
          window.location.href = "index.html";
        });
      } else {
        // Isi form dengan data lama
        document.getElementById("nama").value = data[index].nama;
        document.getElementById("umur").value = data[index].umur;
        document.getElementById("alamat").value = data[index].alamat;
      }

      form.addEventListener("submit", function (e) {
        e.preventDefault();

        const nama = document.getElementById("nama").value.trim();
        const umur = document.getElementById("umur").value.trim();
        const alamat = document.getElementById("alamat").value.trim();

        if (!nama || !umur || !alamat) {
          Swal.fire("Error", "Semua field wajib diisi!", "error");
          return;
        }

        // Update data
        data[index] = { nama, umur, alamat };
        localStorage.setItem("dataDiri", JSON.stringify(data));

        Swal.fire({
          icon: "success",
          title: "Tersimpan!",
          text: "Data berhasil diperbarui.",
          confirmButtonColor: "#2575fc",
        }).then(() => {
          window.location.href = "index.html";
        });
      });
    </script>
  </body>
</html>
